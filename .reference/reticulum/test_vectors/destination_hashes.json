{
  "description": "Reticulum v1.1.3 reference implementation - destination hash test vectors",
  "source": "RNS/Destination.py",
  "constants": {
    "name_hash_length_bits": 80,
    "name_hash_length_bytes": 10,
    "truncated_hash_length_bits": 128,
    "truncated_hash_length_bytes": 16
  },
  "algorithm": {
    "step_1": "base_name = app_name + '.' + aspect1 + '.' + aspect2 + ... (no identity hash)",
    "step_2": "name_hash = SHA-256(base_name.encode('utf-8'))[:10]",
    "step_3": "addr_hash_material = name_hash + identity_hash (26 bytes for SINGLE destinations)",
    "step_4": "destination_hash = SHA-256(addr_hash_material)[:16]",
    "plain_note": "For PLAIN destinations, addr_hash_material = name_hash only (10 bytes, no identity_hash)",
    "full_name_note": "expand_name(identity, ...) appends '.' + identity.hexhash to the base name"
  },
  "single_destinations": [
    {
      "app_name": "rns_unit_tests",
      "aspects": [
        "link",
        "establish"
      ],
      "base_name": "rns_unit_tests.link.establish",
      "base_name_note": "expand_name(None, app_name, *aspects) \u2014 without identity hash suffix",
      "full_name": "rns_unit_tests.link.establish.650b5d76b6bec0390d1f8cfca5bd33f9",
      "full_name_note": "expand_name(identity, app_name, *aspects) \u2014 with identity hexhash suffix",
      "name_hash": "528b84ff9fa689c05795",
      "name_hash_length_bytes": 10,
      "identity_hash": "650b5d76b6bec0390d1f8cfca5bd33f9",
      "addr_hash_material": "528b84ff9fa689c05795650b5d76b6bec0390d1f8cfca5bd33f9",
      "addr_hash_material_length_bytes": 26,
      "destination_hash": "fb48da0e82e6e01ba0c014513f74540d",
      "keypair_index": 0
    },
    {
      "app_name": "rns_unit_tests",
      "aspects": [
        "link",
        "establish"
      ],
      "base_name": "rns_unit_tests.link.establish",
      "base_name_note": "expand_name(None, app_name, *aspects) \u2014 without identity hash suffix",
      "full_name": "rns_unit_tests.link.establish.1469e89450c361b253aefb0c606b6111",
      "full_name_note": "expand_name(identity, app_name, *aspects) \u2014 with identity hexhash suffix",
      "name_hash": "528b84ff9fa689c05795",
      "name_hash_length_bytes": 10,
      "identity_hash": "1469e89450c361b253aefb0c606b6111",
      "addr_hash_material": "528b84ff9fa689c057951469e89450c361b253aefb0c606b6111",
      "addr_hash_material_length_bytes": 26,
      "destination_hash": "70c0d820f77ab30ed32d5e48baa90c28",
      "keypair_index": 1
    },
    {
      "app_name": "rns_unit_tests",
      "aspects": [
        "link",
        "establish"
      ],
      "base_name": "rns_unit_tests.link.establish",
      "base_name_note": "expand_name(None, app_name, *aspects) \u2014 without identity hash suffix",
      "full_name": "rns_unit_tests.link.establish.e5fe93ee4acba095b3b9b6541515ed3e",
      "full_name_note": "expand_name(identity, app_name, *aspects) \u2014 with identity hexhash suffix",
      "name_hash": "528b84ff9fa689c05795",
      "name_hash_length_bytes": 10,
      "identity_hash": "e5fe93ee4acba095b3b9b6541515ed3e",
      "addr_hash_material": "528b84ff9fa689c05795e5fe93ee4acba095b3b9b6541515ed3e",
      "addr_hash_material_length_bytes": 26,
      "destination_hash": "84a963f1b12557d2282434e5a13f56ba",
      "keypair_index": 2
    },
    {
      "app_name": "rns_unit_tests",
      "aspects": [
        "link",
        "establish"
      ],
      "base_name": "rns_unit_tests.link.establish",
      "base_name_note": "expand_name(None, app_name, *aspects) \u2014 without identity hash suffix",
      "full_name": "rns_unit_tests.link.establish.1333b911fa8ebb16726996adbe3c6262",
      "full_name_note": "expand_name(identity, app_name, *aspects) \u2014 with identity hexhash suffix",
      "name_hash": "528b84ff9fa689c05795",
      "name_hash_length_bytes": 10,
      "identity_hash": "1333b911fa8ebb16726996adbe3c6262",
      "addr_hash_material": "528b84ff9fa689c057951333b911fa8ebb16726996adbe3c6262",
      "addr_hash_material_length_bytes": 26,
      "destination_hash": "3cd05751c7689440291428c4ef149b39",
      "keypair_index": 3
    },
    {
      "app_name": "rns_unit_tests",
      "aspects": [
        "link",
        "establish"
      ],
      "base_name": "rns_unit_tests.link.establish",
      "base_name_note": "expand_name(None, app_name, *aspects) \u2014 without identity hash suffix",
      "full_name": "rns_unit_tests.link.establish.d13712efc45ef87674fb5ac26c37c912",
      "full_name_note": "expand_name(identity, app_name, *aspects) \u2014 with identity hexhash suffix",
      "name_hash": "528b84ff9fa689c05795",
      "name_hash_length_bytes": 10,
      "identity_hash": "d13712efc45ef87674fb5ac26c37c912",
      "addr_hash_material": "528b84ff9fa689c05795d13712efc45ef87674fb5ac26c37c912",
      "addr_hash_material_length_bytes": 26,
      "destination_hash": "c0e20981a67b1c758a30d06fbdf63a9b",
      "keypair_index": 4
    },
    {
      "app_name": "myapp",
      "aspects": [
        "delivery"
      ],
      "base_name": "myapp.delivery",
      "base_name_note": "expand_name(None, app_name, *aspects) \u2014 without identity hash suffix",
      "full_name": "myapp.delivery.650b5d76b6bec0390d1f8cfca5bd33f9",
      "full_name_note": "expand_name(identity, app_name, *aspects) \u2014 with identity hexhash suffix",
      "name_hash": "0904c781ad9e31cdfe21",
      "name_hash_length_bytes": 10,
      "identity_hash": "650b5d76b6bec0390d1f8cfca5bd33f9",
      "addr_hash_material": "0904c781ad9e31cdfe21650b5d76b6bec0390d1f8cfca5bd33f9",
      "addr_hash_material_length_bytes": 26,
      "destination_hash": "92bedc7d6c6ff98ec066547488ace4c1",
      "keypair_index": 0
    },
    {
      "app_name": "myapp",
      "aspects": [
        "messaging",
        "incoming"
      ],
      "base_name": "myapp.messaging.incoming",
      "base_name_note": "expand_name(None, app_name, *aspects) \u2014 without identity hash suffix",
      "full_name": "myapp.messaging.incoming.650b5d76b6bec0390d1f8cfca5bd33f9",
      "full_name_note": "expand_name(identity, app_name, *aspects) \u2014 with identity hexhash suffix",
      "name_hash": "3fa9664ccbc1dfe1f4f3",
      "name_hash_length_bytes": 10,
      "identity_hash": "650b5d76b6bec0390d1f8cfca5bd33f9",
      "addr_hash_material": "3fa9664ccbc1dfe1f4f3650b5d76b6bec0390d1f8cfca5bd33f9",
      "addr_hash_material_length_bytes": 26,
      "destination_hash": "316fd21e33a4e662bfc65f08ca451fe4",
      "keypair_index": 0
    },
    {
      "app_name": "lxmf",
      "aspects": [
        "delivery"
      ],
      "base_name": "lxmf.delivery",
      "base_name_note": "expand_name(None, app_name, *aspects) \u2014 without identity hash suffix",
      "full_name": "lxmf.delivery.650b5d76b6bec0390d1f8cfca5bd33f9",
      "full_name_note": "expand_name(identity, app_name, *aspects) \u2014 with identity hexhash suffix",
      "name_hash": "6ec60bc318e2c0f0d908",
      "name_hash_length_bytes": 10,
      "identity_hash": "650b5d76b6bec0390d1f8cfca5bd33f9",
      "addr_hash_material": "6ec60bc318e2c0f0d908650b5d76b6bec0390d1f8cfca5bd33f9",
      "addr_hash_material_length_bytes": 26,
      "destination_hash": "37db3d4a55697ce40368bf880c560702",
      "keypair_index": 0
    },
    {
      "app_name": "nomadnet",
      "aspects": [
        "node"
      ],
      "base_name": "nomadnet.node",
      "base_name_note": "expand_name(None, app_name, *aspects) \u2014 without identity hash suffix",
      "full_name": "nomadnet.node.650b5d76b6bec0390d1f8cfca5bd33f9",
      "full_name_note": "expand_name(identity, app_name, *aspects) \u2014 with identity hexhash suffix",
      "name_hash": "198ba8884cf7ea1794d4",
      "name_hash_length_bytes": 10,
      "identity_hash": "650b5d76b6bec0390d1f8cfca5bd33f9",
      "addr_hash_material": "198ba8884cf7ea1794d4650b5d76b6bec0390d1f8cfca5bd33f9",
      "addr_hash_material_length_bytes": 26,
      "destination_hash": "32985238c204a2c83e6786feb5b71adb",
      "keypair_index": 0
    }
  ],
  "plain_destinations": [
    {
      "app_name": "rns_unit_tests",
      "aspects": [
        "link",
        "establish"
      ],
      "base_name": "rns_unit_tests.link.establish",
      "name_hash": "528b84ff9fa689c05795",
      "name_hash_length_bytes": 10,
      "identity_hash": null,
      "addr_hash_material": "528b84ff9fa689c05795",
      "addr_hash_material_length_bytes": 10,
      "destination_hash": "a4c9bcd70a33209bb921727c126501af",
      "note": "PLAIN destination: no identity, addr_hash_material is just name_hash"
    },
    {
      "app_name": "myapp",
      "aspects": [
        "discovery"
      ],
      "base_name": "myapp.discovery",
      "name_hash": "94c325e3444eb8a4f6e3",
      "name_hash_length_bytes": 10,
      "identity_hash": null,
      "addr_hash_material": "94c325e3444eb8a4f6e3",
      "addr_hash_material_length_bytes": 10,
      "destination_hash": "50d373e0a2dca4110a8f767644f61456",
      "note": "PLAIN destination: no identity, addr_hash_material is just name_hash"
    }
  ]
}
