{
  "description": "Reticulum v1.1.3 reference implementation - Token (modified Fernet) test vectors",
  "source": "RNS/Cryptography/Token.py, RNS/Cryptography/PKCS7.py",
  "constants": {
    "token_overhead_bytes": 48,
    "token_overhead_note": "16 (IV) + 32 (HMAC-SHA256)",
    "aes_block_size_bytes": 16,
    "hmac_digest_length_bytes": 32,
    "aes_256_key_length_bytes": 32,
    "total_token_key_length_bytes": 64
  },
  "token_format": {
    "description": "Modified Fernet: no VERSION or TIMESTAMP fields (unlike standard Fernet)",
    "layout": "IV (16 bytes) || AES-256-CBC(PKCS7.pad(plaintext)) || HMAC-SHA256(signing_key, IV || ciphertext)",
    "key_split": "64-byte key -> signing_key = key[:32], encryption_key = key[32:]"
  },
  "pkcs7_padding": [
    {
      "description": "empty (0 bytes)",
      "input": "",
      "input_length": 0,
      "padded": "10101010101010101010101010101010",
      "padded_length": 16,
      "pad_byte": "10",
      "pad_length": 16
    },
    {
      "description": "1 byte",
      "input": "01",
      "input_length": 1,
      "padded": "010f0f0f0f0f0f0f0f0f0f0f0f0f0f0f",
      "padded_length": 16,
      "pad_byte": "0f",
      "pad_length": 15
    },
    {
      "description": "15 bytes",
      "input": "000102030405060708090a0b0c0d0e",
      "input_length": 15,
      "padded": "000102030405060708090a0b0c0d0e01",
      "padded_length": 16,
      "pad_byte": "01",
      "pad_length": 1
    },
    {
      "description": "16 bytes (full block)",
      "input": "000102030405060708090a0b0c0d0e0f",
      "input_length": 16,
      "padded": "000102030405060708090a0b0c0d0e0f10101010101010101010101010101010",
      "padded_length": 32,
      "pad_byte": "10",
      "pad_length": 16
    },
    {
      "description": "31 bytes",
      "input": "000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e",
      "input_length": 31,
      "padded": "000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e01",
      "padded_length": 32,
      "pad_byte": "01",
      "pad_length": 1
    }
  ],
  "hmac_sha256": [
    {
      "description": "key=32 zero bytes, msg=empty",
      "key": "0000000000000000000000000000000000000000000000000000000000000000",
      "message": "",
      "digest": "b613679a0814d9ec772f95d778c35fc5ff1697c493715653c6c712144292c5ad",
      "digest_length": 32
    },
    {
      "description": "key=32 zero bytes, msg='abc'",
      "key": "0000000000000000000000000000000000000000000000000000000000000000",
      "message": "616263",
      "digest": "fd7adb152c05ef80dccf50a1fa4c05d5a3ec6da95575fc312ae7c5d091836351",
      "digest_length": 32
    },
    {
      "description": "key='Reticulum' padded to 32, msg='Hello'",
      "key": "5265746963756c756d0000000000000000000000000000000000000000000000",
      "message": "48656c6c6f",
      "digest": "6e3f1b183e46ace66ec2a775276e231ce9758cd453e056580db70e835ddc1953",
      "digest_length": 32
    },
    {
      "description": "key=all 0xff (32 bytes), msg=16 zero bytes",
      "key": "ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",
      "message": "00000000000000000000000000000000",
      "digest": "a1f809ce5e92c149371164dcf393a073f12e4d82042fbb9889ff40fbe336a41a",
      "digest_length": 32
    }
  ],
  "deterministic_fernet_vectors": [
    {
      "description": "17-byte plaintext (1 block + 1 byte)",
      "key": "000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f",
      "key_split": {
        "signing_key": "000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f",
        "encryption_key": "202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f",
        "note": "64-byte key split: first 32 bytes = signing_key, last 32 bytes = encryption_key"
      },
      "iv": "10101010101010101010101010101010",
      "plaintext": "48656c6c6f2c205265746963756c756d21",
      "padded_plaintext": "48656c6c6f2c205265746963756c756d210f0f0f0f0f0f0f0f0f0f0f0f0f0f0f",
      "ciphertext": "a43bad588aa8d8fce1f49ea3e2b7848624c2654f38e3768a8e589cdf589bee40",
      "signed_parts": "10101010101010101010101010101010a43bad588aa8d8fce1f49ea3e2b7848624c2654f38e3768a8e589cdf589bee40",
      "signed_parts_note": "IV + ciphertext (input to HMAC)",
      "hmac": "28e7338c24ee2fc0d7367a9f4904be15275b37f308a2637a3cb6cf70fefef015",
      "token": "10101010101010101010101010101010a43bad588aa8d8fce1f49ea3e2b7848624c2654f38e3768a8e589cdf589bee4028e7338c24ee2fc0d7367a9f4904be15275b37f308a2637a3cb6cf70fefef015",
      "token_layout": {
        "iv_offset": 0,
        "iv_length": 16,
        "ciphertext_offset": 16,
        "ciphertext_length": 32,
        "hmac_offset": 48,
        "hmac_length": 32,
        "total_length": 80
      },
      "plaintext_utf8": "Hello, Reticulum!"
    },
    {
      "description": "Empty plaintext (0 bytes, pure PKCS7 padding block)",
      "key": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa",
      "key_split": {
        "signing_key": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa",
        "encryption_key": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa",
        "note": "64-byte key split: first 32 bytes = signing_key, last 32 bytes = encryption_key"
      },
      "iv": "bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb",
      "plaintext": "",
      "padded_plaintext": "10101010101010101010101010101010",
      "ciphertext": "109e1b328671f599d27414ed1a428099",
      "signed_parts": "bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb109e1b328671f599d27414ed1a428099",
      "signed_parts_note": "IV + ciphertext (input to HMAC)",
      "hmac": "ba0f284a3c6edbb3617459edf0e5e470931d02f973daa10fb2effcfee3a918ae",
      "token": "bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb109e1b328671f599d27414ed1a428099ba0f284a3c6edbb3617459edf0e5e470931d02f973daa10fb2effcfee3a918ae",
      "token_layout": {
        "iv_offset": 0,
        "iv_length": 16,
        "ciphertext_offset": 16,
        "ciphertext_length": 16,
        "hmac_offset": 32,
        "hmac_length": 32,
        "total_length": 64
      },
      "plaintext_utf8": ""
    },
    {
      "description": "48-byte plaintext (3 blocks, requires extra padding block)",
      "key": "404142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f707172737475767778797a7b7c7d7e7f",
      "key_split": {
        "signing_key": "404142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f",
        "encryption_key": "606162636465666768696a6b6c6d6e6f707172737475767778797a7b7c7d7e7f",
        "note": "64-byte key split: first 32 bytes = signing_key, last 32 bytes = encryption_key"
      },
      "iv": "000102030405060708090a0b0c0d0e0f",
      "plaintext": "000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f",
      "padded_plaintext": "000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f10101010101010101010101010101010",
      "ciphertext": "79360fe3bdfe0c08397ce765006daf36da3ae2e0b1eefb293a58e5678d8313dedeb4b5b2407165813b6992916b4c69b5019cf897fed2ea929c675d6d8d8ad9c3",
      "signed_parts": "000102030405060708090a0b0c0d0e0f79360fe3bdfe0c08397ce765006daf36da3ae2e0b1eefb293a58e5678d8313dedeb4b5b2407165813b6992916b4c69b5019cf897fed2ea929c675d6d8d8ad9c3",
      "signed_parts_note": "IV + ciphertext (input to HMAC)",
      "hmac": "e8df990f71fe7ad8400eb345c28b5d42c8599d1c77cf7eb037ea555e078309fa",
      "token": "000102030405060708090a0b0c0d0e0f79360fe3bdfe0c08397ce765006daf36da3ae2e0b1eefb293a58e5678d8313dedeb4b5b2407165813b6992916b4c69b5019cf897fed2ea929c675d6d8d8ad9c3e8df990f71fe7ad8400eb345c28b5d42c8599d1c77cf7eb037ea555e078309fa",
      "token_layout": {
        "iv_offset": 0,
        "iv_length": 16,
        "ciphertext_offset": 16,
        "ciphertext_length": 64,
        "hmac_offset": 80,
        "hmac_length": 32,
        "total_length": 112
      },
      "plaintext_utf8": "\u0000\u0001\u0002\u0003\u0004\u0005\u0006\u0007\b\t\n\u000b\f\r\u000e\u000f\u0010\u0011\u0012\u0013\u0014\u0015\u0016\u0017\u0018\u0019\u001a\u001b\u001c\u001d\u001e\u001f !\"#$%&'()*+,-./"
    }
  ],
  "fixed_token_decomposition": {
    "description": "Decomposition of fixed_token from tests/identity.py (Identity.encrypt output)",
    "fixed_token": "e37705f9b432d3711acf028678b0b9d37fdf7e00a3b47c95251aad61447df2620b5b9978783c3d9f2fb762e68c8b57c554928fb70dd79c1033ce5865f91761aad3e992790f63456092cb69b7b045f539147f7ba10d480e300f193576ae2d75a7884809b76bd17e05a735383305c0aa5621395bbf51e8cc66c1c536f339f2bea600f08f8f9a76564b2522cd904b6c2b6e553ec3d4df718ae70434c734297b313539338d184d2c64a9c4ddbc9b9a4947d0b45f5a274f65ae9f6bb203562fd5cede6abd3c615b699156e08fa33b841647a0",
    "total_length": 208,
    "layout": {
      "ephemeral_public_key": {
        "offset": 0,
        "length": 32,
        "value": "e37705f9b432d3711acf028678b0b9d37fdf7e00a3b47c95251aad61447df262",
        "note": "X25519 ephemeral public key for ECDH"
      },
      "fernet_token": {
        "offset": 32,
        "length": 176,
        "value": "0b5b9978783c3d9f2fb762e68c8b57c554928fb70dd79c1033ce5865f91761aad3e992790f63456092cb69b7b045f539147f7ba10d480e300f193576ae2d75a7884809b76bd17e05a735383305c0aa5621395bbf51e8cc66c1c536f339f2bea600f08f8f9a76564b2522cd904b6c2b6e553ec3d4df718ae70434c734297b313539338d184d2c64a9c4ddbc9b9a4947d0b45f5a274f65ae9f6bb203562fd5cede6abd3c615b699156e08fa33b841647a0",
        "components": {
          "iv": {
            "offset": 0,
            "length": 16,
            "value": "0b5b9978783c3d9f2fb762e68c8b57c5"
          },
          "ciphertext": {
            "offset": 16,
            "length": 128,
            "value": "54928fb70dd79c1033ce5865f91761aad3e992790f63456092cb69b7b045f539147f7ba10d480e300f193576ae2d75a7884809b76bd17e05a735383305c0aa5621395bbf51e8cc66c1c536f339f2bea600f08f8f9a76564b2522cd904b6c2b6e553ec3d4df718ae70434c734297b313539338d184d2c64a9c4ddbc9b9a4947d0"
          },
          "hmac": {
            "offset": 144,
            "length": 32,
            "value": "b45f5a274f65ae9f6bb203562fd5cede6abd3c615b699156e08fa33b841647a0"
          }
        }
      }
    },
    "plaintext": "71884a271ead43558fcf1e331c5aebcd43498f16da16f8056b0893ce6b15d521eaa4f31639cd34da1b57995944076c4f14f300f2d2612111d21a3429a9966ac1da68545c00c7887d8b26f6c1ab9defa020b9519849ca41b7904199882802b6542771df85144a79890289d3c02daef6c26652c5ce9de231a2",
    "decryption_note": "Decryption-only vector. The ephemeral key is random, so encryption is non-deterministic."
  }
}
